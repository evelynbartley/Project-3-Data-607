---
title: "DATA607 Project 3 - Data Science Soft Skills - Preliminary Analyses"
author: "Drafted by Alexander Simon for Project 3 Team 1"
date: "2024-03-12"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(kableExtra)
library(RColorBrewer)
library(tidyverse)
library(wordcloud)

kbl_display <- function(df, box_width, box_height = NULL) {
# This function uses the kableExtra package to display a dataframe (df).
# In an HTML document, if the table exceeds the specified dimensions it will be shown in a scrollable box.
#
# Arguments:
# box_width <chr>: Width of scroll box, in pixels (eg, "200 px") or percentage of total screen width (eg, "100%")
# box_height <chr>: [Optional] Height of scroll box, in pixels or percentage
  
  if (!is.null(box_height)) {
    df %>%
      kbl() %>%
      kable_material() %>%
      scroll_box(width = box_width, height = box_height)
  } else {
    df %>%
      kbl() %>%
      kable_material() %>%
      scroll_box(width = box_width)
  }
}
```

<br>

### Data

Soft skills were collated from 65 websites identified by Google searches. Search queries included:

-   "soft skills" "data science"

-   companies that hire data scientists "soft skills"

-   data scientist recruit "soft skills"

Data were saved as a CSV file and input from GitHub.

```{r read-raw-data}
soft_skills_raw <- read_csv('https://media.githubusercontent.com/media/alexandersimon1/Data607/main/Project3/data_science_soft_skills.csv', show_col_types = FALSE)
```

<br>

### Definition of value

The "value" of a skill was defined as its frequency in the dataset (ie, a skill that is mentioned on many websites would be a highly valued skill).

```{r glimpse, include=FALSE}
glimpse(soft_skills_raw)
```

```{r select-columns, include=FALSE}
soft_skills <- soft_skills_raw %>%
  select(Company, Author_name_last, Author_name_first, Field, Audience, Skill, Rank, Date_pub)
```

<br>

## Communication is the most common (valued) soft skills overall

```{r top-skills-overall}
top_skills_overall <- soft_skills %>%
  group_by(Skill) %>%
  tally() %>%
  arrange(desc(n))

kbl_display(head(top_skills_overall, 10), "40%")
```

<br>

#### Word cloud

```{r group-low-counts}
top_skills_overall <- top_skills_overall %>%
  mutate(
    Skill_category = if_else(n > 2, Skill, "Other")
  )
```

```{r top-skills-wordcloud, fig.height=6}
set.seed(1234)
wordcloud(words = top_skills_overall$Skill_category, 
          freq = top_skills_overall$n, min.freq = 3,
          max.words = 50, random.order = FALSE, rot.per = 0,
          colors = brewer.pal(5, "Dark2"))
```

#### Barplot

```{r top-skills-overall-barplot, fig.height=6}
ggplot(filter(top_skills_overall, n > 2), aes(x = reorder(Skill, n), y = n)) +
  geom_bar(stat = 'identity') + 
  xlab("Soft skill") + ylab("Count") + theme(axis.title = element_text(face = "bold")) +
  coord_flip()
```

## Communication has consistently been the most common (valued) soft skill over time

### However the number of other skills of interest is increasing

```{r top-skills-by-year}
top_skills_year <- soft_skills %>%
  group_by(year = lubridate::year(Date_pub), Skill) %>%
  tally() %>%
  arrange(desc(n))
```

```{r filter-rows-year}
top_skills_year <- drop_na(top_skills_year, year)
top_skills_year <- top_skills_year %>%
  filter(n > 2)
```

```{r top-skills-by-year-barplot}
ggplot(top_skills_year, aes(x = factor(year), y = n, fill = Skill)) +
  geom_bar(stat = 'identity', position = 'fill') +
  xlab("Year") + ylab("Proportion") + theme(axis.title = element_text(face = "bold")) +
  labs(caption = "Data as of March 2024")
```

## The most common (valued) soft skills vary by target audience

```{r skills-by-audience, message = FALSE}
top_skills_audience <- soft_skills %>%
  group_by(Audience, Skill) %>%
  summarise(
    n = n()
  ) %>%
  mutate(
    freq = n / sum(n)
  ) %>%
  arrange(desc(freq))
```

```{r filter-rows-field}
top_skills_audience <- top_skills_audience %>%
  filter(n > 3)
```

```{r skill-proportion-barplot}
order <- c("General", "Students", "Job seekers", "Employees", "Companies")
ggplot(top_skills_audience, aes(x = Audience, y = freq, fill = Skill)) +
  geom_col(position = "fill") +
  scale_x_discrete(limits = order) +
  xlab("Target audience") + ylab("Proportion") + 
  theme(axis.title = element_text(face = "bold"))
```
